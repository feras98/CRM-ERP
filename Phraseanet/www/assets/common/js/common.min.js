function unfix_tooltip(){$.tooltip.blocked=!1,$.tooltip.visible=!1,$.tooltip.current=null,$("#tooltip").hide(),$("#tooltip .tooltip_closer").hide(),commonModule.hideOverlay("_tooltip")}var p4=p4||{},utilsModule=function(e){function t(e,t,o){return i(e)+i(t)+i(o)}function i(e){return null===e?"00":(e=parseInt(e),0===e||isNaN(e)?"00":(e=Math.max(0,e),e=Math.min(e,255),e=Math.round(e),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)))}function o(e,t,i){var o,a,r,s,l,u;return t/=100,i/=100,0===t?s=l=u=255*i:(a=i<=.5?i*(t+1):i+t-i*t,o=2*i-a,r=e/360,s=n(o,a,r+1/3),l=n(o,a,r),u=n(o,a,r-1/3)),{r:s,g:l,b:u}}function n(e,t,i){var o;return i<0?i+=1:i>1&&(i-=1),o=6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e,255*o}function a(e){return!!e.altKey||(!!e.ctrlKey||(!!e.metaKey||(17===e.keyCode||(224===e.keyCode||91===e.keyCode))))}function r(e){return!!e.shiftKey}return{RGBtoHex:t,hsl2rgb:o,is_ctrl_key:a,is_shift_key:r}}(p4),userModule=function(){function e(e,t){jQuery.data["pref_"+e]&&jQuery.data["pref_"+e].abort&&(jQuery.data["pref_"+e].abort(),jQuery.data["pref_"+e]=!1),jQuery.data["pref_"+e]=$.ajax({type:"POST",url:"/user/preferences/",data:{prop:e,value:t},dataType:"json",timeout:function(){jQuery.data["pref_"+e]=!1},error:function(){jQuery.data["pref_"+e]=!1},success:function(t){t.success?humane.info(t.message):humane.error(t.message),jQuery.data["pref_"+e]=!1}})}return{setPref:e}}();!function(e){function t(t){var i=t||window.event,o=[].slice.call(arguments,1),n=0,a=0,r=0;return t=e.event.fix(i),t.type="mousewheel",i.wheelDelta&&(n=i.wheelDelta/120),i.detail&&(n=-i.detail/3),r=n,void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(r=0,a=-1*n),void 0!==i.wheelDeltaY&&(r=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(a=-1*i.wheelDeltaX/120),o.unshift(t,n,a,r),(e.event.dispatch||e.event.handle).apply(this,o)}var i=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var o=i.length;o;)e.event.fixHooks[i[--o]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=i.length;e;)this.addEventListener(i[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),jQuery(function(e){e.datepicker.regional.ar={closeText:"إغلاق",prevText:"&#x3C;السابق",nextText:"التالي&#x3E;",currentText:"اليوم",monthNames:["كانون الثاني","شباط","آذار","نيسان","مايو","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],dayNamesShort:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],dayNamesMin:["ح","ن","ث","ر","خ","ج","س"],weekHeader:"أسبوع",dateFormat:"dd/mm/yy",firstDay:6,isRTL:!0,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.ar)}),jQuery(function(e){e.datepicker.regional.de={closeText:"Schließen",prevText:"&#x3C;Zurück",nextText:"Vor&#x3E;",currentText:"Heute",monthNames:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],weekHeader:"KW",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.de)}),jQuery(function(e){e.datepicker.regional.es={closeText:"Cerrar",prevText:"&#x3C;Ant",nextText:"Sig&#x3E;",currentText:"Hoy",monthNames:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],monthNamesShort:["ene","feb","mar","abr","may","jun","jul","ogo","sep","oct","nov","dic"],dayNames:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],dayNamesShort:["dom","lun","mar","mié","juv","vie","sáb"],dayNamesMin:["D","L","M","X","J","V","S"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.es)}),jQuery(function(e){e.datepicker.regional.fr={closeText:"Fermer",prevText:"Précédent",nextText:"Suivant",currentText:"Aujourd'hui",monthNames:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],monthNamesShort:["janv.","févr.","mars","avril","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dayNames:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],dayNamesShort:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],dayNamesMin:["D","L","M","M","J","V","S"],weekHeader:"Sem.",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.fr)}),jQuery(function(e){e.datepicker.regional.nl={closeText:"Sluiten",prevText:"←",nextText:"→",currentText:"Vandaag",monthNames:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],monthNamesShort:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],dayNames:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],dayNamesShort:["zon","maa","din","woe","don","vri","zat"],dayNamesMin:["zo","ma","di","wo","do","vr","za"],weekHeader:"Wk",dateFormat:"dd-mm-yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional.nl)}),jQuery(function(e){e.datepicker.regional["en-GB"]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"dd/mm/yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional["en-GB"])}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return s.raw?e:encodeURIComponent(e)}function i(e){return s.raw?e:decodeURIComponent(e)}function o(e){return t(s.json?JSON.stringify(e):String(e))}function n(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(r," ")),s.json?JSON.parse(e):e}catch(t){}}function a(t,i){var o=s.raw?t:n(t);return e.isFunction(i)?i(o):o}var r=/\+/g,s=e.cookie=function(n,r,l){if(void 0!==r&&!e.isFunction(r)){if(l=e.extend({},s.defaults,l),"number"==typeof l.expires){var u=l.expires,d=l.expires=new Date;d.setTime(+d+864e5*u)}return document.cookie=[t(n),"=",o(r),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var c=n?void 0:{},h=document.cookie?document.cookie.split("; "):[],p=0,f=h.length;p<f;p++){var m=h[p].split("="),v=i(m.shift()),g=m.join("=");if(n&&n===v){c=a(g,r);break}n||void 0===(g=a(g))||(c[v]=g)}return c};s.defaults={},e.removeCookie=function(t,i){return void 0!==e.cookie(t)&&(e.cookie(t,"",e.extend({},i,{expires:-1})),!e.cookie(t))}}),function(e){e.contextMenu={_showEvent:null,_div:null,openEvt:"contextmenu",closeTimer:null,shadow:!0,dropDown:!1,shadowOffset:0,shadowOffsetX:5,shadowOffsetY:5,shadowWidthAdjust:-3,shadowHeightAdjust:-3,shadowOpacity:.2,shadowClass:"context-menu-shadow",shadowColor:"black",offsetX:0,offsetY:0,appendTo:"body",direction:"down",constrainToScreen:!0,showTransition:"show",hideTransition:"hide",showSpeed:"",hideSpeed:"",showCallback:null,hideCallback:null,className:"context-menu",itemClassName:"context-menu-item",itemHoverClassName:"context-menu-item-hover",disabledItemClassName:"context-menu-item-disabled",disabledItemHoverClassName:"context-menu-item-disabled-hover",separatorClassName:"context-menu-separator",innerDivClassName:"context-menu-item-inner",themePrefix:"context-menu-theme-",theme:"default",separator:"context-menu-separator",target:null,menu:null,shadowObj:null,bgiframe:null,shown:!1,useIframe:!1,create:function(t,i){var o=e.extend({},this,i);return"string"==typeof t?o.menu=e(t):"function"==typeof t?o.menuFunction=t:o.menu=o.createMenu(t,o),o.menu&&(o.menu.css({display:"none"}),e(o.appendTo).append(o.menu)),o.shadow&&(o.createShadow(o),o.shadowOffset&&(o.shadowOffsetX=o.shadowOffsetY=o.shadowOffset)),e("body").bind(o.openEvt,function(){o.hide()}),o},createIframe:function(){return e('<iframe frameborder="0" tabindex="-1" src="javascript:false" style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=0);"/>')},createMenu:function(t,i){var o=i.className;e.each(i.theme.split(","),function(e,t){o+=" "+i.themePrefix+t});var n=e('<table style="" cellspacing="0" cellpadding="0"></table>').click(function(){return i.hide(),!1}),a=e("<tr></tr>"),r=e("<td></td>"),s=i._div=e('<div class="'+o+'"></div>');i._div.hover(function(){i.closeTimer&&(clearTimeout(i.closeTimer),i.closeTimer=null)},function(){function e(){t.hide()}var t=i;t.closeTimer=setTimeout(e,500)});for(var l=0;l<t.length;l++){var u=t[l];u==e.contextMenu.separator?s.append(i.createSeparator()):s.append(i.createMenuItem(u))}return i.useIframe&&r.append(i.createIframe()),n.append(a.append(r.append(s))),n},createMenuItem:function(t){var i=this,o=t.label;"function"==typeof t&&(t={onclick:t});var n=e.extend({onclick:function(){},className:"",hoverClassName:i.itemHoverClassName,icon:"",disabled:!1,title:"",hoverItem:i.hoverItem,hoverItemOut:i.hoverItemOut},t),a=n.icon?"background-image:url("+n.icon+");":"",r=e('<div class="'+i.itemClassName+" "+n.className+(n.disabled?" "+i.disabledItemClassName:"")+'" title="'+n.title+'"></div>').click(function(e){return!i.isItemDisabled(this)&&n.onclick.call(i.target,this,i,e,o)}).hover(function(){n.hoverItem.call(this,i.isItemDisabled(this)?i.disabledItemHoverClassName:n.hoverClassName)},function(){n.hoverItemOut.call(this,i.isItemDisabled(this)?i.disabledItemHoverClassName:n.hoverClassName)}),s=e('<div class="'+i.innerDivClassName+'" style="'+a+'">'+o+"</div>");return r.append(s),r},createSeparator:function(){return e('<div class="'+this.separatorClassName+'"></div>')},isItemDisabled:function(t){return e(t).is("."+this.disabledItemClassName)},hoverItem:function(t){e(this).addClass(t)},hoverItemOut:function(t){e(this).removeClass(t)},createShadow:function(t){t.shadowObj=e('<div class="'+t.shadowClass+'"></div>').css({display:"none",position:"absolute",zIndex:9998,opacity:t.shadowOpacity,backgroundColor:t.shadowColor}),e(t.appendTo).append(t.shadowObj)},showShadow:function(e,t,i){var o=this;o.shadow&&o.shadowObj.css({width:o.menu.width()+o.shadowWidthAdjust+"px",height:o.menu.height()+o.shadowHeightAdjust+"px",top:t+o.shadowOffsetY+"px",left:e+o.shadowOffsetX+"px"}).addClass(o.shadowClass)[o.showTransition](o.showSpeed)},beforeShow:function(){return!0},show:function(t,i){var o=this,n=i.pageX,a=i.pageY;if(o._div&&o._div.css("height","auto").css("overflow-y","auto"),o.target=t,o._showEvent=i,o.beforeShow()!==!1){o.menuFunction&&(o.menu&&e(o.menu).remove(),o.menu=o.createMenu(o.menuFunction(o,t),o),o.menu.css({display:"none"}),e(o.appendTo).append(o.menu));var r=o.menu;n+=o.offsetX,a+=o.offsetY;var s=o.getPosition(n,a,o,i);if(o.showShadow(s.x,s.y,i),o.useIframe&&r.find("iframe").css({width:r.width()+o.shadowOffsetX+o.shadowWidthAdjust,height:r.height()+o.shadowOffsetY+o.shadowHeightAdjust}),o.dropDown){r.css("visibility","hidden").show();var l={x:e(window).width(),y:e(window).height()};e(t).offset().top+e(t).outerHeight()+r.height()>l.y?e(t).offset().left+e(t).outerWidth()+r.width()>l.x?r.css({top:e(t).offset().top-r.outerHeight()+"px",left:e(t).offset().left-r.outerWidth()+"px",position:"absolute",zIndex:9999})[o.showTransition](o.showSpeed,o.showCallback?function(){o.showCallback.call(o)}:null):r.css({top:e(t).offset().top-r.outerHeight()+"px",left:e(t).offset().left+"px",position:"absolute",zIndex:9999})[o.showTransition](o.showSpeed,o.showCallback?function(){o.showCallback.call(o)}:null):e(t).offset().left+e(t).outerWidth()+r.width()>l.x?r.css({top:e(t).offset().top+e(t).outerHeight()+"px",left:e(t).offset().left-r.outerWidth()+"px",position:"absolute",zIndex:9999})[o.showTransition](o.showSpeed,o.showCallback?function(){o.showCallback.call(o)}:null):r.css({top:e(t).offset().top+e(t).outerHeight()+"px",left:e(t).offset().left+"px",position:"absolute",zIndex:9999})[o.showTransition](o.showSpeed,o.showCallback?function(){o.showCallback.call(o)}:null),r.css("visibility","visible")}else r.css({top:s.y+"px",left:s.x+"px",position:"absolute",zIndex:9999})[o.showTransition](o.showSpeed,o.showCallback?function(){o.showCallback.call(o)}:null);o.shown=!0,e(document).one("click",null,function(){o.hide()})}},getPosition:function(t,i,o,n){var a=t+o.offsetX,r=i+o.offsetY,s=e(o.menu).height(),l=e(o.menu).width();o.direction;if(o.constrainToScreen){var u=e(window),d=u.height(),c=u.width(),h=u.scrollTop(),p=r-h-5,f=d+h-r-5;s>f&&(s>p?p>f?(s=p,o._div.css("height",s+"px").css("overflow-y","scroll"),r-=s):(s=f,o._div.css("height",s+"px").css("overflow-y","scroll")):r-=s);var m=a+l-u.scrollLeft();m>c&&(a-=m-c)}return{x:a,y:r}},hide:function(){var t=this;t.shown&&(t.iframe&&e(t.iframe).hide(),t.menu&&t.menu[t.hideTransition](t.hideSpeed,t.hideCallback?function(){t.hideCallback.call(t)}:null),t.shadow&&t.shadowObj[t.hideTransition](t.hideSpeed)),t.shown=!1}},e.fn.contextMenu=function(t,i){var o=e.contextMenu.create(t,i);return this.each(function(){e(this).bind(o.openEvt,function(t){return o.menu.is(":visible")?o.hide():(e("body").trigger(o.openEvt),o.show(this,t)),!1}).bind("mouseover",function(){return!1})})}}(jQuery);var p4=p4||{},datepickerLang=[],commonModule=function(e,t){function i(t,i,o,n){var a="OVERLAY";"undefined"!=typeof t&&(a+=t),0===e("#"+a).length&&("undefined"==typeof i&&(i="body"),e(i).append('<div id="'+a+'" style="display:none;">&nbsp;</div>'));var r={display:"block",opacity:0,right:0,bottom:0,position:"absolute",top:0,zIndex:n,left:0};parseInt(n)>0&&(r.zIndex=parseInt(n)),"function"!=typeof o&&(o=function(){}),e("#"+a).css(r).addClass("overlay").fadeTo(500,.7).bind("click",function(){o()}),navigator.userAgent.match(/msie/i)&&navigator.userAgent.match(/6/)&&e("select").css({visibility:"hidden"})}function o(t){navigator.userAgent.match(/msie/i)&&navigator.userAgent.match(/6/)&&e("select").css({visibility:"visible"});var i="OVERLAY";"undefined"!=typeof t&&(i+=t),e("#"+i).hide().remove()}function n(t){e("#DIALOG").attr("title","").empty().append(t.attr("infos")).dialog({title:"About",autoOpen:!1,closeOnEscape:!0,resizable:!1,draggable:!1,width:600,height:400,modal:!0,overlay:{backgroundColor:"#000",opacity:.7}}).dialog("open").css({"overflow-x":"auto","overflow-y":"hidden",padding:"0"})}function a(t,i,o){var n={"update-session":o?"0":"1"};null!==t&&(n["user-id"]=t),e.ajax({type:"GET",url:"/user/notifications/",dataType:"json",data:{offset:0,limit:10,what:2},headers:n,error:function(e){e.getResponseHeader("x-phraseanet-end-session")&&self.location.replace(self.location.href)},timeout:function(){o&&window.setTimeout(function(){a(t,i,o)},1e4)},success:function(e){i&&s(e),o&&window.setTimeout(function(){a(t,i,o)},3e4)}})}function r(t){return e.ajax({type:"PATCH",url:"/user/notifications/"+t+"/",data:{read:1},success:function(){a(null,!0,!1)}})}function s(t){var i=e("#notification_box"),o=e(".notifications",i);if(o.empty(),0===t.notifications.notifications.length)e(".no_notifications",i).show();else{e(".no_notifications",i).hide();for(var n in t.notifications.notifications){var a=t.notifications.notifications[n],s=e(a.html);e(".icon_unread",s).click(a.id,function(e){r(e.data)}),o.append(s)}}var l=e(".notification_trigger");if(t.notifications.unread_count>0?e(".counter",l).empty().append(t.notifications.unread_count).show():e(".counter",l).hide().empty(),t.unread_basket_ids.length>0)for(var u=e(".SSTT.ui-state-active"),d=(u.length>0&&u.attr("id").split("_").pop(),!1),c=0;c!=t.unread_basket_ids.length;c++){var h=e("#SSTT_"+t.unread_basket_ids[c]);0===h.size()?d===!1&&(e("#baskets .bloc").animate({top:30},function(){e("#baskets .alert_datas_changed:first").show()}),d=!0):h.hasClass("active")?e(".alert_datas_changed",e("#SSTT_content_"+t.unread_basket_ids[c])).show():h.addClass("unread")}return""!==e.trim(t.message)&&(0===e("#MESSAGE").length&&e("body").append('<div id="#MESSAGE"></div>'),e("#MESSAGE").empty().append('<div style="margin:30px 10px;"><h4><b>'+t.message+'</b></h4></div><div style="margin:20px 0px 10px;"><label class="checkbox"><input type="checkbox" class="dialog_remove" />'+language.hideMessage+"</label></div>").attr("title","Global Message").dialog({autoOpen:!1,closeOnEscape:!0,resizable:!1,draggable:!1,modal:!0,close:function(){e(".dialog_remove:checked",e(this)).length>0&&e.ajax({type:"POST",url:"/user/preferences/temporary/",data:{prop:"message",value:0},success:function(e){}})}}).dialog("open")),!0}return e(document).ready(function(){e("input.input-button").hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});var i=e.cookie("locale"),o=t.lng="undefined"!=typeof i?i.split("_").reverse().pop():e("html").attr("lang");"en"==o&&(o="en-GB"),e.datepicker.setDefaults({showMonthAfterYear:!1}),e.datepicker.setDefaults(e.datepicker.regional[o]),datepickerLang=e.datepicker.regional[o];var a=e("#mainMenu .helpcontextmenu");e(".context-menu-item",a).hover(function(){e(this).addClass("context-menu-item-hover")},function(){e(this).removeClass("context-menu-item-hover")}),e("body").on("click",".infoDialog",function(t){n(e(this))})}),{showOverlay:i,hideOverlay:o,markNotificationRead:r,pollNotifications:a}}(jQuery,p4);!function(e){function t(t){f.parent||(f.parent=e('<div id="'+t.id+'"><div class="body"></div></div>').appendTo(document.body).hide(),e.fn.bgiframe&&f.parent.bgiframe(),f.title=e("h3",f.parent),f.body=e("div.body",f.parent),f.url=e("div.url",f.parent))}function i(t){return e.data(t,"tooltip")}function o(t){e(e.tooltip.current).hasClass("SSTT")&&e(e.tooltip.current).hasClass("ui-state-active")||(i(this).delay?p=setTimeout(l,i(this).delay):l(),r(),v=!!i(this).track,e(document.body).bind("mousemove",u),u(t))}function n(t){t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,!e.tooltip.blocked&&this!=e.tooltip.current&&(this.tooltipText||this.tooltipSrc||i(this).bodyHandler)&&(e.tooltip.current=this,h=this.tooltipText,i(this).showURL&&e(this).url()?f.url.html(e(this).url().replace("http://","")).show():f.url.hide(),f.parent.removeClass(),f.parent.addClass(i(this).extraClass),this.ajaxLoad?(clearTimeout(e.tooltip.ajaxTimeout),e.tooltip.ajaxTimeout=setTimeout("$.tooltip.delayAjax()",300),e.tooltip.ajaxEvent=t):(h='<div class="popover" style="display:block;position:relative;"><div class="arrow"></div><div class="popover-inner" style="width:auto;"><div class="popover-content">'+h+"</div></div></div>",a.apply(this,arguments)))}function a(t){f.body.html(h),f.body.show();var n=e.tooltip.current,a=i(n)?i(n):{},r=e.tooltip.blocked;if(a.fixPNG&&f.parent.fixPNG(),a.outside){var s=a.id,l=e("#"+s),u=e("#"+s+" .audioTips"),c=e("#"+s+" .imgTips"),p=e("#"+s+" .videoTips"),m=e("#"+s+" .documentTips"),v=0===e("#"+s+" .noToolTipResize").length,g=260,y=0,b=75,w=35,x=1024,k=768,T=0,S=0,C=d(),j=0,$=0,I=0,M=0,A=0,N=0,O=0,D=0,_=l;if(c[0]&&v)g=parseInt(c[0].style.width),y=parseInt(c[0].style.height),c.css({display:"block",margin:"0 auto"}),_=c;else if(m[0]&&v)g=m.data("original-width")>400?m.data("original-width"):400,y=m.data("original-width")>400?m.data("original-height"):600,m.css({display:"block",margin:"0 auto"}),_=m;else if(u[0]&&v)g=240,y=240,u.css({display:"block",margin:"0 auto"}),_=u;else if(p[0]&&v)g=p.data("original-width"),y=p.data("original-height"),p.css({display:"block",margin:"0 auto"}),_=p;else{var E=_.get(0).offsetHeight;v=!1,b=13,y=E>k?k:E,_.css({height:"auto"})}T=g+w,S=y+b;var L=function(e,t,i,o,n,a,r){var s=o/i,l=i,u=o;return i>o?(l>e&&(l=e,u=e*s),u>t&&(l=t/s,u=t)):u>t&&(l=t/s,u=t),void 0!==n&&void 0!==a&&(l>n||u>a)?L(n,a,i,o):(void 0!==r&&r.css({width:Math.floor(l),height:Math.floor(u)}),{width:Math.floor(l),height:Math.floor(u)})};if(t){var z=e(t.target),R=z.closest(".diapo");R.length>0?(I=R.width()-2,M=R.height()+2,A=14,N=1,O=2,D=-15):(w=0,A=50,R=z);var H=R.offset(),F=C.x,V=C.y,B=H.left+N,P=H.top+A,G=F-B-I-O,K=V-P-M,Q=!1,W=K,Y={width:T,height:S},U="top";switch(P>K&&(Q=!0,W=P),U=B>G?"left":"right",K>B&&K>G?U="bottom":Q&&W>B&&W>G&&(U="top"),r===!0&&(B=F,P=V,U="top"),U){case"top":Y=L(F,P,T,S,x,k),T=Y.width,S=Y.height,j=B-Y.width/2+I/2,$=P-Y.height;break;case"bottom":Y=L(F,K,T,S,x,k),T=Y.width,S=Y.height,j=B-Y.width/2+I/2,$=V-K+D;break;case"left":Y=L(B,V,T,S,x,k),T=Y.width,S=Y.height,j=B-Y.width;break;case"right":Y=L(G,V,T,S,x,k),T=Y.width,S=Y.height,j=B+I+O}if(r===!0)j=F/2-T/2,$=V/2-S/2;else{if("left"===U||"right"===U){var J=P+M/2+S/2;$=J<V?P+M/2-S/2:V-S,$=$<0?0:$}if("top"===U||"bottom"===U){var X=T/2+B,q=T/2+G;j=X>F||q>F?B>F/2?0:F-T:B-T/2+I/2}}var Z={left:j,top:$};v?(L(T-w,S-b,g,y,x,k,_),Z["max-width"]="",Z["min-width"]=""):(Z["max-width"]=Math.round(T),Z["min-width"]=Math.round(T)),Z.width=v?Math.round(T):"auto",Z.height=v?Math.round(S):"auto",f.parent.css(Z)}}o.apply(n,arguments)}function r(){p=null;var t=!1;null!==e.tooltip.current&&(t=i(e.tooltip.current).isBrowsable),m&&e.fn.bgiframe||!i(e.tooltip.current).fade?f.parent.show():f.parent.is(":animated")?f.parent.stop().show().fadeTo(i(e.tooltip.current).fade,100):f.parent.is(":visible")?f.parent.fadeTo(i(e.tooltip.current).fade,100):f.parent.fadeIn(i(e.tooltip.current).fade),e(f.parent[0]).unbind("mouseenter").unbind("mouseleave").mouseenter(function(){t&&(e.tooltip.currentHover=!0)}).mouseleave(function(){t&&(e.tooltip.currentHover=!1,f.parent.hide())}),u()}function s(t){return i(this).fixable?(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),commonModule.showOverlay("_tooltip","body",unfix_tooltip,i(this).fixableIndex),e("#tooltip .tooltip_closer").show().bind("click",unfix_tooltip),e.tooltip.blocked=!0,void a.apply(this,arguments)):void c(t)}function l(){e.tooltip.visible=!0,f.parent.css({visibility:"visible"})}function u(t){if(!(e.tooltip.blocked||t&&"OPTION"==t.target.tagName)){if(!v&&f.parent.is(":visible")&&(e(document.body).unbind("mousemove",u),e.tooltip.currentHover=!0),null===e.tooltip.current)return e(document.body).unbind("mousemove",u),void(e.tooltip.currentHover=!1);if(f.parent.removeClass("viewport-right").removeClass("viewport-bottom"),!i(e.tooltip.current).outside){var o=f.parent[0].offsetLeft,n=f.parent[0].offsetTop;if(f.parent.width("auto"),f.parent.height("auto"),t){o=t.pageX+i(e.tooltip.current).left,n=t.pageY+i(e.tooltip.current).top;var a="auto";i(e.tooltip.current).positionLeft&&(a=e(window).width()-o,o="auto"),f.parent.css({left:o,right:a,top:n})}var r=d(),s=f.parent[0];r.x+r.cx<s.offsetLeft+s.offsetWidth&&(o-=s.offsetWidth+20+i(e.tooltip.current).left,f.parent.css({left:o+"px"}).addClass("viewport-right")),r.y+r.cy<s.offsetTop+s.offsetHeight&&(n-=s.offsetHeight+20+i(e.tooltip.current).top,f.parent.css({top:n+"px"}).addClass("viewport-bottom"))}}}function d(){return{x:e(window).width(),y:e(window).height(),cx:0,cy:0}}function c(t){function o(){f.parent.removeClass(a.extraClass).hide().css("opacity","")}var n=!1;if(null!==e.tooltip.current&&(n=i(e.tooltip.current).isBrowsable),(!e.tooltip.currentHover||!n)&&!e.tooltip.blocked&&e.tooltip.current){e(f.parent[0]).unbind("mouseenter").unbind("mouseleave"),p&&clearTimeout(p),e.tooltip.visible=!1;var a=i(e.tooltip.current);clearTimeout(e.tooltip.ajaxTimeout),e.tooltip.ajaxRequest&&e.tooltip.ajaxRequest.abort&&e.tooltip.ajaxRequest.abort(),f.body.empty(),e.tooltip.current=null,m&&e.fn.bgiframe||!a.fade?o():f.parent.is(":animated")?f.parent.stop().fadeTo(a.fade,0,o):f.parent.stop().fadeOut(a.fade,o),a.fixPNG&&f.parent.unfixPNG()}}var h,p,f={},m=navigator.userAgent.match(/msie/i)&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),v=!1;e.tooltip={blocked:!1,ajaxTimeout:!1,ajaxRequest:!1,ajaxEvent:!1,current:null,visible:!1,defaults:{delay:700,fixable:!1,fixableIndex:100,fade:!0,showURL:!0,outside:!0,isBrowsable:!1,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){e.tooltip.blocked=!e.tooltip.blocked},delayAjax:function(t,i,o){var n=p4.tot_options,r=p4.tot_query,s={options_serial:n,query:r};e.tooltip.ajaxRequest=e.ajax({url:e.tooltip.current.tooltipSrc,type:"post",data:s,success:function(t){h=t,a(e.tooltip.ajaxEvent)},error:function(){}})}},e.fn.extend({tooltip:function(i){return i=e.extend({},e.tooltip.defaults,i),t(i),this.each(function(){e.data(this,"tooltip",i),this.tooltipText=e(this).attr("title"),this.tooltipSrc=e(this).attr("tooltipsrc"),this.ajaxLoad=""===e.trim(this.tooltipText)&&""!==this.tooltipSrc,this.ajaxTimeout,this.orEl=e(this),e(this).removeAttr("title"),this.alt=""}).mouseover(n).mouseout(c).mouseleave(function(){i.isBrowsable&&(e.tooltip.currentHover=!1,setTimeout(function(){c()},500))}).mousedown(s)},fixPNG:m?function(){return this.each(function(){var t=e(this).css("backgroundImage");t.match(/^url\(["']?(.*\.png)["']?\)$/i)&&(t=RegExp.$1,e(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+t+"')"}).each(function(){var t=e(this).css("position");"absolute"!=t&&"relative"!=t&&e(this).css("position","relative")}))})}:function(){return this},unfixPNG:m?function(){return this.each(function(){e(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){e(this)[e(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}})}(jQuery),$(document).bind("keydown",function(e){void 0!==$.tooltip&&27==e.keyCode&&$.tooltip.blocked===!0&&unfix_tooltip()});var dialogModule=function(e){function t(e){return e=parseInt(e),isNaN(e)||e<1?1:e}function i(e){return"DIALOG"+t(e)}function o(e,t){return t.options.closeButton===!0&&(e[language.fermer]=function(){t.close()}),t.options.cancelButton===!0&&(e[language.annuler]=function(){t.close()}),e}var n=null,a={},r={};e("document").ready(function(){n=e("body"),e(window).on("resize",function(){a.y=n.height(),a.x=n.width(),e(".overlay").height(a.y).width(a.x)})});var s=function(r,s){var l,u,d=function(t){var o=e("#"+i(t));if(o.length>0)throw"Dialog already exists at this level";return o=e('<div style="display:none;" id="'+i(t)+'"></div>'),e("body").append(o),o},c={size:"Medium",buttons:{},loading:!0,title:"",closeOnEscape:!0,confirmExit:!1,closeCallback:!1,closeButton:!1,cancelButton:!1},r="object"==typeof r?r:{},h=this;if(this.closing=!1,this.options=e.extend(c,r),this.level=t(s),this.options.buttons=o(this.options.buttons,this),/\d+x\d+/.test(this.options.size)){var p=this.options.size.split("x");u=p[1],l=p[0]}else switch(a.y=n.height(),a.x=n.width(),this.options.size){case"Full":u=a.y-30,l=a.x-30;break;case"Medium":l=Math.min(a.x-30,730),u=Math.min(a.y-30,520);break;default:case"Small":l=Math.min(a.x-30,420),u=Math.min(a.y-30,300);break;case"Alert":l=Math.min(a.x-30,300),u=Math.min(a.y-30,150)}this.$dialog=d(this.level),zIndex=Math.min(5e3*this.level+5e3,32767);var f=function(){"function"==typeof h.options.closeCallback&&h.options.closeCallback(h.$dialog),h.closing===!1&&(h.closing=!0,h.close())};if(this.$dialog.data("ui-dialog")&&this.$dialog.dialog("destroy"),this.$dialog.attr("title",this.options.title).empty().dialog({buttons:this.options.buttons,draggable:!1,resizable:!1,closeOnEscape:this.options.closeOnEscape,modal:!0,width:l,height:u,open:function(){e(this).dialog("widget").css("z-index",zIndex)},close:f}).dialog("open").addClass("dialog-"+this.options.size),this.options.loading===!0&&this.$dialog.addClass("loading"),"Full"===this.options.size){var h=this;e(window).unbind("resize.DIALOG"+t(s)).bind("resize.DIALOG"+t(s),function(){h.$dialog.data("ui-dialog")&&h.$dialog.dialog("option",{width:a.x-30,height:a.y-30})})}return this};s.prototype={close:function(){r.close(this.level)},setContent:function(e){this.$dialog.removeClass("loading").empty().append(e)},getId:function(){return this.$dialog.attr("id")},load:function(t,i,o){var n=this;this.loader={url:t,method:"undefined"==typeof i?"GET":i,params:"undefined"==typeof o?{}:o},e.ajax({type:this.loader.method,url:this.loader.url,dataType:"html",data:this.loader.params,beforeSend:function(){},success:function(e){n.setContent(e)},error:function(){},timeout:function(){}})},refresh:function(){if("undefined"==typeof this.loader)throw"Nothing to refresh";this.load(this.loader.url,this.loader.method,this.loader.params)},getDomElement:function(){return this.$dialog},getOption:function(e){return this.$dialog.data("ui-dialog")?this.$dialog.dialog("option",e):null},setOption:function(e,t){"buttons"===e&&(t=o(t,this)),this.$dialog.data("ui-dialog")&&this.$dialog.dialog("option",e,t)}};var l=function(){this.currentStack={}};return l.prototype={create:function(e,t){return this.get(t)instanceof s&&this.get(t).close(),$dialog=new s(e,t),this.currentStack[$dialog.getId()]=$dialog,$dialog},get:function(e){var t=i(e);return t in this.currentStack?this.currentStack[t]:null},close:function(i){e(window).unbind("resize.DIALOG"+t(i)),this.get(i).closing=!0;var o=this.get(i).getDomElement();o.data("ui-dialog")&&o.dialog("close").dialog("destroy"),o.remove();var n=this.get(i).getId();n in this.currentStack&&delete this.currentStack.id}},r=new l,{dialog:r}}(jQuery);!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.download=t()}(this,function(){return function e(t,i,o){function n(e){var t=e.split(/[:;,]/),i=t[1],o="base64"==t[2]?atob:decodeURIComponent,n=o(t.pop()),a=n.length,r=0,s=new Uint8Array(a);for(r;r<a;++r)s[r]=n.charCodeAt(r);return new m([s],{type:i})}function a(e,t){if("download"in p)return p.href=e,p.setAttribute("download",v),p.className="download-js-link",p.innerHTML="downloading...",p.style.display="none",document.body.appendChild(p),setTimeout(function(){p.click(),document.body.removeChild(p),t===!0&&setTimeout(function(){l.URL.revokeObjectURL(p.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return e=e.replace(/^data:([\w\/\-\+]+)/,u),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var i=document.createElement("iframe");document.body.appendChild(i),t||(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,u)),i.src=e,setTimeout(function(){document.body.removeChild(i)},333)}var r,s,l=window,u="application/octet-stream",d=o||u,c=t,h=!i&&!o&&c,p=document.createElement("a"),f=function(e){return String(e)},m=l.Blob||l.MozBlob||l.WebKitBlob||f,v=i||"download";if(m=m.call?m.bind(l):Blob,"true"===String(this)&&(c=[c,d],d=c[0],c=c[1]),h&&h.length<2048&&(v=h.split("/").pop().split("?")[0],p.href=h,p.href.indexOf(h)!==-1)){var g=new XMLHttpRequest;return g.open("GET",h,!0),g.responseType="blob",g.onload=function(t){e(t.target.response,v,u)},setTimeout(function(){g.send()},0),g}if(/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(c)){if(!(c.length>2096103.424&&m!==f))return navigator.msSaveBlob?navigator.msSaveBlob(n(c),v):a(c);c=n(c),d=c.type||u}if(r=c instanceof m?c:new m([c],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(r,v);if(l.URL)a(l.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===f)try{
return a("data:"+d+";base64,"+l.btoa(r))}catch(y){return a("data:"+d+","+encodeURIComponent(r))}s=new FileReader,s.onload=function(e){a(this.result)},s.readAsDataURL(r)}return!0}}),!function(e){"use strict";function t(t,i){this.isInit=!0,this.itemsArray=[],this.$element=e(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.objectItems=i&&i.itemValue,this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=e('<div class="bootstrap-tagsinput"></div>'),this.$input=e('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(i),this.isInit=!1}function i(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(e){return e[i]}}}function o(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(){return i}}}function n(e){return e?l.text(e).html():""}function a(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function r(t,i){var o=!1;return e.each(i,function(e,i){if("number"==typeof i&&t.which===i)return o=!0,!1;if(t.which===i.which){var n=!i.hasOwnProperty("altKey")||t.altKey===i.altKey,a=!i.hasOwnProperty("shiftKey")||t.shiftKey===i.shiftKey,r=!i.hasOwnProperty("ctrlKey")||t.ctrlKey===i.ctrlKey;if(n&&a&&r)return o=!0,!1}}),o}var s={tagClass:function(e){return"label label-info"},focusClass:"focus",itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},itemTitle:function(e){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,triggerChange:!0};t.prototype={constructor:t,add:function(t,i,o){var a=this;if(!(a.options.maxTags&&a.itemsArray.length>=a.options.maxTags)&&(t===!1||t)){if("string"==typeof t&&a.options.trimValue&&(t=e.trim(t)),"object"==typeof t&&!a.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(a.isSelect&&!a.multiple&&a.itemsArray.length>0&&a.remove(a.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var r=a.options.delimiterRegex?a.options.delimiterRegex:a.options.delimiter,s=t.split(r);if(s.length>1){for(var l=0;l<s.length;l++)this.add(s[l],!0);return void(i||a.pushVal(a.options.triggerChange))}}var u=a.options.itemValue(t),d=a.options.itemText(t),c=a.options.tagClass(t),h=a.options.itemTitle(t),p=e.grep(a.itemsArray,function(e){return a.options.itemValue(e)===u})[0];if(!p||a.options.allowDuplicates){if(!(a.items().toString().length+t.length+1>a.options.maxInputLength)){var f=e.Event("beforeItemAdd",{item:t,cancel:!1,options:o});if(a.$element.trigger(f),!f.cancel){a.itemsArray.push(t);var m=e('<span class="tag '+n(c)+(null!==h?'" title="'+h:"")+'">'+n(d)+'<span data-role="remove"></span></span>');m.data("item",t),a.findInputWrapper().before(m),m.after(" ");var v=e('option[value="'+encodeURIComponent(u)+'"]',a.$element).length||e('option[value="'+n(u)+'"]',a.$element).length;if(a.isSelect&&!v){var g=e("<option selected>"+n(d)+"</option>");g.data("item",t),g.attr("value",u),a.$element.append(g)}i||a.pushVal(a.options.triggerChange),(a.options.maxTags===a.itemsArray.length||a.items().toString().length===a.options.maxInputLength)&&a.$container.addClass("bootstrap-tagsinput-max"),e(".typeahead, .twitter-typeahead",a.$container).length&&a.$input.typeahead("val",""),this.isInit?a.$element.trigger(e.Event("itemAddedOnInit",{item:t,options:o})):a.$element.trigger(e.Event("itemAdded",{item:t,options:o}))}}}else if(a.options.onTagExists){var y=e(".tag",a.$container).filter(function(){return e(this).data("item")===p});a.options.onTagExists(t,y)}}}},remove:function(t,i,o){var n=this;if(n.objectItems&&(t="object"==typeof t?e.grep(n.itemsArray,function(e){return n.options.itemValue(e)==n.options.itemValue(t)}):e.grep(n.itemsArray,function(e){return n.options.itemValue(e)==t}),t=t[t.length-1]),t){var a=e.Event("beforeItemRemove",{item:t,cancel:!1,options:o});if(n.$element.trigger(a),a.cancel)return;e(".tag",n.$container).filter(function(){return e(this).data("item")===t}).remove(),e("option",n.$element).filter(function(){return e(this).data("item")===t}).remove(),-1!==e.inArray(t,n.itemsArray)&&n.itemsArray.splice(e.inArray(t,n.itemsArray),1)}i||n.pushVal(n.options.triggerChange),n.options.maxTags>n.itemsArray.length&&n.$container.removeClass("bootstrap-tagsinput-max"),n.$element.trigger(e.Event("itemRemoved",{item:t,options:o}))},removeAll:function(){var t=this;for(e(".tag",t.$container).remove(),e("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal(t.options.triggerChange)},refresh:function(){var t=this;e(".tag",t.$container).each(function(){var i=e(this),o=i.data("item"),a=t.options.itemValue(o),r=t.options.itemText(o),s=t.options.tagClass(o);if(i.attr("class",null),i.addClass("tag "+n(s)),i.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=n(r),t.isSelect){var l=e("option",t.$element).filter(function(){return e(this).data("item")===o});l.attr("value",a)}})},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=e.map(t.items(),function(e){return t.options.itemValue(e).toString()});t.$element.val(i,!0),t.options.triggerChange&&t.$element.trigger("change")},build:function(t){var n=this;if(n.options=e.extend({},s,t),n.objectItems&&(n.options.freeInput=!1),i(n.options,"itemValue"),i(n.options,"itemText"),o(n.options,"tagClass"),n.options.typeahead){var l=n.options.typeahead||{};o(l,"source"),n.$input.typeahead(e.extend({},l,{source:function(t,i){function o(e){for(var t=[],o=0;o<e.length;o++){var r=n.options.itemText(e[o]);a[r]=e[o],t.push(r)}i(t)}this.map={};var a=this.map,r=l.source(t);e.isFunction(r.success)?r.success(o):e.isFunction(r.then)?r.then(o):e.when(r).then(o)},updater:function(e){return n.add(this.map[e]),this.map[e]},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(n.options.typeaheadjs){var u=null,d={},c=n.options.typeaheadjs;e.isArray(c)?(u=c[0],d=c[1]):d=c,n.$input.typeahead(u,d).on("typeahead:selected",e.proxy(function(e,t){d.valueKey?n.add(t[d.valueKey]):n.add(t),n.$input.typeahead("val","")},n))}n.$container.on("click",e.proxy(function(e){n.$element.attr("disabled")||n.$input.removeAttr("disabled"),n.$input.focus()},n)),n.options.addOnBlur&&n.options.freeInput&&n.$input.on("focusout",e.proxy(function(t){0===e(".typeahead, .twitter-typeahead",n.$container).length&&(n.add(n.$input.val()),n.$input.val(""))},n)),n.$container.on({focusin:function(){n.$container.addClass(n.options.focusClass)},focusout:function(){n.$container.removeClass(n.options.focusClass)}}),n.$container.on("keydown","input",e.proxy(function(t){var i=e(t.target),o=n.findInputWrapper();if(n.$element.attr("disabled"))return void n.$input.attr("disabled","disabled");switch(t.which){case 8:if(0===a(i[0])){var r=o.prev();r.length&&n.remove(r.data("item"))}break;case 46:if(0===a(i[0])){var s=o.next();s.length&&n.remove(s.data("item"))}break;case 37:var l=o.prev();0===i.val().length&&l[0]&&(l.before(o),i.focus());break;case 39:var u=o.next();0===i.val().length&&u[0]&&(u.after(o),i.focus())}var d=i.val().length;Math.ceil(d/5),i.attr("size",Math.max(this.inputSize,i.val().length))},n)),n.$container.on("keypress","input",e.proxy(function(t){var i=e(t.target);if(n.$element.attr("disabled"))return void n.$input.attr("disabled","disabled");var o=i.val(),a=n.options.maxChars&&o.length>=n.options.maxChars;n.options.freeInput&&(r(t,n.options.confirmKeys)||a)&&(0!==o.length&&(n.add(a?o.substr(0,n.options.maxChars):o),i.val("")),n.options.cancelConfirmKeysOnEmpty===!1&&t.preventDefault());var s=i.val().length;Math.ceil(s/5),i.attr("size",Math.max(this.inputSize,i.val().length))},n)),n.$container.on("click","[data-role=remove]",e.proxy(function(t){n.$element.attr("disabled")||n.remove(e(t.target).closest(".tag").data("item"))},n)),n.options.itemValue===s.itemValue&&("INPUT"===n.$element[0].tagName?n.add(n.$element.val()):e("option",n.$element).each(function(){n.add(e(this).attr("value"),!0)}))},destroy:function(){var e=this;e.$container.off("keypress","input"),e.$container.off("click","[role=remove]"),e.$container.remove(),e.$element.removeData("tagsinput"),e.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],i=this.$container[0];t&&t.parentNode!==i;)t=t.parentNode;return e(t)}},e.fn.tagsinput=function(i,o,n){var a=[];return this.each(function(){var r=e(this).data("tagsinput");if(r)if(i||o){if(void 0!==r[i]){if(3===r[i].length&&void 0!==n)var s=r[i](o,null,n);else var s=r[i](o);void 0!==s&&a.push(s)}}else a.push(r);else r=new t(this,i),e(this).data("tagsinput",r),a.push(r),"SELECT"===this.tagName&&e("option",e(this)).attr("selected","selected"),e(this).val(e(this).val())}),"string"==typeof i?a.length>1?a:a[0]:a},e.fn.tagsinput.Constructor=t;var l=e("<div />");e(function(){e("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery);